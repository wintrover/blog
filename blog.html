---
layout: default
permalink: /
---

<div class="blog-page">
    <div class="posts" id="posts-container">
        {% assign all_posts = site.posts %}
        {% for post in all_posts %}
        <article class="post" data-category="{{ post.category | slugify }}">
            <div class="post-meta">
                <span class="date">{{ post.date | date: "%Y-%m-%d" }}</span>
                {% if post.category %}
                <span class="category-badge {{ post.category | slugify }}">{{ post.category }}</span>
                {% endif %}
            </div>
            <h1><a href="{{ site.baseurl }}{{ post.url }}">{{ post.title }}</a></h1>
            {% if post.excerpt %}
            <div class="post-excerpt">{{ post.excerpt | strip_html | truncatewords: 30 }}</div>
            {% endif %}
        </article>
        {% endfor %}
    </div>

    <div class="no-posts" id="no-posts" style="display: none;">
        <p>해당 카테고리에 포스트가 없습니다.</p>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // URL 파라미터에서 카테고리 읽기
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // 카테고리별 포스트 필터링
        function filterPostsByCategory(category) {
            var posts = document.querySelectorAll('.post');
            var postsContainer = document.getElementById('posts-container');
            var noPostsMessage = document.getElementById('no-posts');
            var hasVisiblePosts = false;

            posts.forEach(function (post) {
                var postCategory = post.getAttribute('data-category');

                if (category === 'all' || category === '' || postCategory === category) {
                    post.style.display = 'block';
                    hasVisiblePosts = true;
                } else {
                    post.style.display = 'none';
                }
            });

            // 포스트가 없을 경우 메시지 표시
            if (!hasVisiblePosts) {
                postsContainer.style.display = 'none';
                noPostsMessage.style.display = 'block';
            } else {
                postsContainer.style.display = 'block';
                noPostsMessage.style.display = 'none';
            }
        }

        // 사이드바 카테고리 링크 활성화
        function updateSidebarActiveState(category) {
            var categoryLinks = document.querySelectorAll('.category-link');
            categoryLinks.forEach(function (link) {
                link.classList.remove('active');
                var linkCategory = link.getAttribute('data-category');
                if ((category === 'all' || category === '') && linkCategory === 'all') {
                    link.classList.add('active');
                } else if (linkCategory === category) {
                    link.classList.add('active');
                }
            });
        }

        // 페이지 로드 시 초기 설정
        var initialCategory = getUrlParameter('category') || 'all';
        filterPostsByCategory(initialCategory);
        updateSidebarActiveState(initialCategory);

        // 사이드바 카테고리 링크 클릭 이벤트
        var categoryLinks = document.querySelectorAll('.category-link');
        categoryLinks.forEach(function (link) {
            link.addEventListener('click', function (e) {
                e.preventDefault();

                var category = this.getAttribute('data-category');

                // URL 업데이트 (페이지 새로고침 없이)
                var baseUrl = '{{ site.baseurl }}/';
                var newUrl = baseUrl + (category !== 'all' ? '?category=' + category : '');
                window.history.pushState({ category: category }, '', newUrl);

                // 필터링 및 사이드바 업데이트
                filterPostsByCategory(category);
                updateSidebarActiveState(category);
            });
        });

        // 브라우저 뒤로/앞으로 가기 버튼 처리
        window.addEventListener('popstate', function (e) {
            var category = (e.state && e.state.category) ? e.state.category : 'all';
            filterPostsByCategory(category);
            updateSidebarActiveState(category);
        });
    });
</script>